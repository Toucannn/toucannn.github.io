<link
  rel="stylesheet"
  href="/TartuFlood/style.css"
/>
<body style="display: flex; flex-direction: row; margin: 0">
  <div style="width: 20vw; height: 100vh; background-color: rgb(252, 252, 252); display: flex; flex-direction: column;">
    <button style="margin-left : 50px; margin-right: 50px; margin-bottom: 20px; margin-top: 30px;">
      <a href="/TartuFlood/map.html">Kaardi vaade</a>
    </button>

    <button style="margin-left : 50px; margin-right: 50px; margin-bottom: 20px;">
      <a href="/assets/downloads/andmed.zip" download>
        Andmete allalaadmine
      </a>
    </button>
  
    <button style="margin-left : 50px; margin-right: 50px; margin-bottom: 20px;">
      <a href="https://tartuulikool-my.sharepoint.com/:f:/g/personal/ats989_ut_ee/IgAhMMMmZuM4RZg2k5GDpIk-Adz8V1WgKzMZtDP3AfPN7K4?e=CHDmbY" target="_blank">
        Lae enda kiht üles
      </a>
    </button>
  </div>

  <div style="width: 60vw; height: max-content; background-color: rgb(233, 239, 241);">
    <h1>Emajõe üleujutuse modelleerimine Tartus</h1>

    <h3>Sissejuhatus</h3>

    <p>Selles töötoas modelleerime kaardil Emajõe veetaseme tõusuga kaasnevaid üleujutusi. Emajõe veetase on pidevas muutumises, suuremaid üleujutusi näeb enamasti kevadel. 2025. aastal oli suurem üleujutus veebruaris-märtsis, kui Ihaste luht Emajõe idapoolsel kaldal oli täielikult üle ujutatud, jäätus ja leidis kohalike poolt kasutust uisuplatsina.</p>

    <p>Üleujutuste põhjuseid on mitmeid, mis koosmõjus üksteist võimendavad. Lumerohke talv suure veevaruga lumes annab sulades suure potentsiaali veetaseme tõusuks. Sügavalt läbi külmunud maapind ei võta vett vastu, seega liigub vesi jõge mööda Peipsi suunas. Veetase sõltub veel Peipsi järve veetasemest ja jääoludest: kui veetase on kõrge ja sissevool takistatud, paisub jõgi aina enam üle kallaste.</p>

    <img src="/assets/img/supilinn_20_saj.png" alt="">
    <p style="padding-left: 10%; font-weight: 600;">Sagedane olukord Tartus, Supilinnas 20. sajandi alguses</p>

    <h3>Töökeskkonna ettevalmistamine</h3>

    <p>Modelleerimiseks kasutame tarkvara QGIS, mis võimaldab meil ruumiandmeid töödelda. Töökeskkonna ettevalmistamiseks tee läbi järgmised sammud:</p>

    <ul>
      <li>Ava arvutis tarkvara QGIS</li>
      <li>Loo uus projekt: kliki "New Empty Project" või tööriistaribalt Project → New</li>
      <li>Salvesta projekt arvutis sellisesse kausta, kust selle hiljem üles leiaksid. Näiteks Documents või Desktop. Project → Save As... → vali failile sobiv nimi ja kaust → Save</li>
      <li>Lae arvutisse alla andmed <a href="/assets/downloads/andmed.zip" download>siit lingilt</a></li>
      <li>Ava kaust, kuhu andmed alla laadisid ja lohista kaust andmed.zip QGIS-i aknasse, et et andmed kuvada</li>
      <li>Avanenud aknas näed, milliseid kihte lisada. Kaks kihti on juba valitud, seega kliki Add Layers</li>
    </ul>

    <p>Pärast kihtide lisamist peaks QGIS-is näha olema sarnane vaade:</p>
    <img src="/assets/img/QGIS_andmed_valmis.png">

    <h3>Aluskaardi lisamine</h3>

    <p>Andmed on küll edukalt lisatud, kuid puudub kontekst: me näeme kaardil mingeid kihte, aga me ei tea, mida need kihid ruumis kujutavad. Selleks, et paremini aru saada, millist piirkonda kihid kujutavad, lisame projekti Maa- ja Ruumiameti aluskaardi.</p>

    <ul>
      <li>Vali vasakpoolsest Browser menüüst WMS/WMTS → New Connection...</li>
      <li>Avanenud dialoogiaknas sisesta Connection Details all ühenduse nimi (Name), mille võid ise valida. Näiteks "Maa- ja Ruumiameti aluskaart"</li>
      <li>Lahtrisse URL kopeeri kaardi aadress: http://kaart.maaamet.ee/wms/fotokaart</li>
      <li>Muud parameetrid võid jätta muutmata → kliki OK</li>
      <li>WMS/WMTS ühenduste all peaksid nüüd nägema ühendust nimega Maa- ja Ruumiameti aluskaart</li>
    </ul>

    <img src="/assets/img/wms_connection.png" alt="">

    <p>Me tahame aluskaardina kasutada Maa- ja Ruumiameti fotokaarti, millele on lisatud hübriidkaart asulate, teede, kohanimede jmt kujutamiseks:</p>

    <ul>
      <li>Ava eelmises sammus loodud ühendus ja leia menüüst Hübriidkaart</li>
      <li>Kaardikihi lisamiseks lohista kiht kaardiaknasse</li>
      <li>Leia menüüst kiht Ortofot ja lohista samuti kaardiaknasse</li>
    </ul>

    <p>Nüüd näed kaardiaknas lisatud aluskaarte, aga kihid kuvatakse kaardil vaikimis selles järjekorras, nagu need lisati. See on justkui võileiva valmistamine: kui lisad kõigepealt või, siis vorsti ja juustu, näed võileival ainult pealmist juustukihti, aga muud komponendid on seal all endiselt olemas. Pindmine ortofoto kiht katab kogu Eestit, seega ei paista selle alt midagi välja. Teiste kihtide nägemiseks tuleb meil lihtsalt kihtide järjekorda muuta.</p>

    <ul>
      <li>Muuda vasakpoolses kihihalduri (Layers) menüüs kihtide järjekorda neid üles-alla lohistades</li>
      <li>Kõige pealmine (nimekirjas ülemine) võiks olla jõgede kiht (vooluveekogud)</li>
      <li>Järgmisena võiks kuvada Tartu_dtm kihi ja siis hübriidkaardi</li>
      <li>Kõige alumine peaks olema kiht Ortofoto</li>
    </ul>

    <p>Pärast järjekorra muutmist peaks kaardipilt paistma sarnane sellega, mis on näha allpool. Ortofoto peal on näha maanteid ja kohanimesid, nende peal on must-valge Tartu_dtm kiht ja kõige peal Tartu piirkonna vooluveekogude kiht.</p>

    <img src="/assets/img/kihihaldur.png" alt="">

    <h3>Üleujutuse modelleerimine</h3>

    <p>Tutvu kaardipildiga, siin näed Tartu piirkonna digitaalset maastikumudelit (ingl. k. Digital Terrain Model ehk DTM). Vali esmalt kiht Tartu_dtm (klikk kihtide menüüs kihi nimel), seejärel vali tööriistaribalt tööriist "Identify features" ja kliki kaardil. Tulemuste aknas peaksid nägema, et Band 1 näitab valitud asukoha kõrgust merepinnast. Antud rastri kiht on 5m resolutsiooniga ehk ühe piksli suurus on 5x5m, kõrgus on arvutatud ala keskmine.</p>
    
    <ul>
      <li>Proovi jõuda arusaamisele, millised piirkonnad kaardil on madalamad ja millised kõrgemad!</li>
    </ul>

    <img src="/assets/img/toolbar.png" alt="">
    <p style="padding-left: 10%; font-weight: 600;">Tööriista "Identify features" asukoht tööriistaribal.</p>

    <p>Aktiveeri kaardil vooluveekogude kiht. Kui see ei ilmu kohe maastikumudeli kihi peal nähtavale, siis veendu, et vasakpoolses kihihalduris oleks vooluveekogude kiht kaardil kõrgemal kui Tartu_dtm kiht. Kihtide järjekorda saad muuta lohistades.</p>
    
    <p>Kui jõe kiht on digitaalse maastikumudeli kihi peal näha, siis proovi jõe aladel klikkides leida, milline on jõe kõrgus merepinnast. See peaks jääma alla 32 meetri. Nüüd, kui meil on jõe pinna kõrgus enam-vähem teada, võime alustada üleujutuse modelleerimisega.</p>

    <ul>
      <li>Ava tööriist "Raster calculator" (tööriistaribalt Raster → Raster calculator…)</li>
    </ul>
    
    
    <img src="/assets/img/ava_raster_calculator.png" alt="">
    <p style="padding-left: 10%; font-weight: 600;">Tööriista "Raster calculator" avamine.</p>

    <p>Me teame, et jõe pinna kõrgus on umbes 31.5m ümber, siis võime proovida, mis juhtuks, kui veetase tõuseks 50cm võrra ehk 32m juurde. Selleks teeme Raster calculatoris järgmised tegevused:</p>

    <ul>
      <li>Vali kasutatavaks kihiks Tartu_dtm@1 (topeltklikk kihil)</li>
      <li>Operaatoriks sobib <, sest me soovime valida välja kõik pikslid, mis on madalama väärtusega kui 32.</li>
      <li>Kirjuta valemikasti lisaks number 32, tulemus peaks olema "Tartu_dtm.tif@1" < 32. Nii valime välja pikslid, mille väärtus on väiksem kui 32</li>
      <li>Salvesta kiht nimega uputus_32m.tif (kliki nupul ...) Kihtide salvestamisel kasuta alati sisukaid nimesid, et teaksid hiljem, millist infot mingi kiht endas kannab</li>
      <li>Output CRS: veendu, et oleks valitud EPSG:3301 – Estonian Coordinate System of 1997</li>
      <li>Kliki OK</li>
    </ul>

    <img src="/assets/img/raster_calculator.png" alt="">

    <p>Kaardile peaksid ilmuma need alad mis jäävad 32 meetrist allapoole. Sellised pikslid on tähistatud väärtused 1 (valge värv) ja pikslid, mis jäävad sellest piirist kõrgemale, on tähistatud väärtusega 0. </p>

    <h3>Üleujutuse kihi stiili kujundamine</h3>

    <p>Vaikimisi on loodud üleujutuse kiht must-valge, mis tähendab, et lisaks üleujutuse alale on näha ka must (üleujutamata ala), mis meile kihina tegelikult huvi ei paku. Muudame kihi stiili nii, et üleujutatud ala oleks sinine, ülejäänud ala aga läbipaistev. Selleks teeme järgmised toimingud:</p>

    <ul>
      <li>Kihihalduris parem klikk kihil uputus_32m → Properties → Symbology.</li>
      <li>Render type → valime Singleband pseudocolor.</li>
      <li>Klikime musta värvi kastil väärtuse 1.0000 kõrval, et värvi muuta. Musta värvi alasid me näha ei taha, seega peidame need valides värvis läbipaistmatuseks (Opacity) väärtuse 0%</li>
      <li>Samamoodi klikime väärtuse 0 värvikastil ja muudame värvi siniseks, muudame taas läbipaistmatuse väärtust (Opacity) ja seame selle 50% peale, et läbi kihi oleks aluskaarti näha</li>
      <li>Ok/Apply</li>
    </ul>

    <p>Üleujutuse kihi stiil on nüüd muudetud ja kui esialgne kõrgusmudeli kiht välja lülitada (kihihalduris linnuke välja kihi Tartu_dtm eest), siis on taustakaardiga näha, millised alad oleksid seatud tingimustel üle ujutatud.</p>

    <p>Kui soovid proovida mõnda kõrgemat või madalamat üleujutuse taset, siis korda Raster calculatoriga arvutust enda parameetritega. Uus kiht tekib taas must-valge kujundusega, aga juba olemasoleva kujunduse saab kergelt kopeerida:</p>

    <ul>
      <li>Parem klikk kihil uputus_32m → Styles → Copy Style → All Style Categories</li>
      <li>Ja kasuta stiili: parem klikk uuel kihil → Styles → Paste Style → All Style Categories</li>
    </ul>

    <h3>Kasutatud materjalid:</h3>
    <ul>
      <li>Suurveed Emajõel, E. Randpuu, 2012. <a href="https://keskkonnaportaal.ee/sites/default/files/2021-12/ilm%20ja%20kliima/Randpuu2012.pdf" target="_blank">https://keskkonnaportaal.ee/sites/default/files/2021-12/ilm%20ja%20kliima/Randpuu2012.pdf</a></li>
      <li>Maa- ja Ruumiameti hübriidkaart. <a href="https://geoportaal.maaamet.ee/est/ruumiandmed/topokaardid-ja-aluskaardid/hubriidkaart-p296.html" target="_blank">https://geoportaal.maaamet.ee/est/ruumiandmed/topokaardid-ja-aluskaardid/hubriidkaart-p296.html</a></li>
    </ul>
  </div>

  <div style="width: 20vw; height: 100vh; background-color: rgb(252, 252, 252);"></div>
</body>